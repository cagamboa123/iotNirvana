/*
 * Copyright (C) 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */

package com.google.cloud.demo.iot.nirvana.common;

import com.google.gson.Gson;
import java.io.UnsupportedEncodingException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.ArrayList;
import java.util.List;
import org.apache.beam.sdk.values.KV;

/**
 * Helper class to generate cities test data
 */
public class TemperatureUtils {

  /**
   * Create a test dataset of cities and return it as a hash map whose key is the MD5 of the
   * latitude and longitude o the city
   */
  public static List<KV<String, CityTemperature>> loadCities()
      throws NoSuchAlgorithmException, UnsupportedEncodingException {
    String citiesTemp =
        "[{\"city\":\"Albania-Tirana\",\"temperature\":\"18\",\"lat\":41.3275459,\"lng\":19.81869819999997},{\"city\":\"Algeria-Algiers\",\"temperature\":\"23\",\"lat\":36.753768,\"lng\":3.0587560999999823},{\"city\":\"Angola-Luanda\",\"temperature\":\"27\",\"lat\":-8.839987599999999,\"lng\":13.289436799999976},{\"city\":\"AntiguaandBarbuda-SaintJohn's\",\"temperature\":\"26\",\"lat\":17.1274104,\"lng\":-61.84677199999999},{\"city\":\"Argentina-BuenosAires\",\"temperature\":\"15\",\"lat\":-34.6036844,\"lng\":-58.381559100000004},{\"city\":\"Armenia-Yerevan\",\"temperature\":\"1\",\"lat\":40.1791857,\"lng\":44.499102900000025},{\"city\":\"Aruba-Oranjestad\",\"temperature\":\"31\",\"lat\":12.5092044,\"lng\":-70.0086306},{\"city\":\"Australia-AustralianCapitalTerritory-Canberra\",\"temperature\":\"8\",\"lat\":-35.3075,\"lng\":149.124417},{\"city\":\"Austria-Vienna-Vienna\",\"temperature\":\"7\",\"lat\":48.2081743,\"lng\":16.37381890000006},{\"city\":\"Azerbaijan-Baku\",\"temperature\":\"8\",\"lat\":40.40926169999999,\"lng\":49.86709240000005},{\"city\":\"Bahamas-Nassau\",\"temperature\":\"28\",\"lat\":25.0479835,\"lng\":-77.355413},{\"city\":\"Bahrain-Manama\",\"temperature\":\"29\",\"lat\":26.2285161,\"lng\":50.58604969999999},{\"city\":\"Bangladesh-Dhaka\",\"temperature\":\"34\",\"lat\":23.810332,\"lng\":90.41251809999994},{\"city\":\"Barbados-Bridgetown\",\"temperature\":\"31\",\"lat\":13.1132219,\"lng\":-59.598808899999995},{\"city\":\"Belarus-Minsk\",\"temperature\":\"1\",\"lat\":53.90453979999999,\"lng\":27.561524400000053},{\"city\":\"Belgium-Brussels\",\"temperature\":\"9\",\"lat\":50.8503396,\"lng\":4.351710300000036},{\"city\":\"Belize-Belmopan\",\"temperature\":\"25\",\"lat\":17.2510114,\"lng\":-88.75902009999999},{\"city\":\"Benin-PortoNovo\",\"temperature\":\"31\",\"lat\":6.4968574,\"lng\":2.6288523000000623},{\"city\":\"Bermuda-Hamilton\",\"temperature\":\"22\",\"lat\":32.294816,\"lng\":-64.78137500000003},{\"city\":\"Bhutan-Thimphu\",\"temperature\":\"-1\",\"lat\":27.4727924,\"lng\":89.63928629999998},{\"city\":\"Bosnia-Herzegovina-Sarajevo\",\"temperature\":\"15\",\"lat\":43.8562586,\"lng\":18.413076300000057},{\"city\":\"Botswana-Gaborone\",\"temperature\":\"36\",\"lat\":-24.6282079,\"lng\":25.92314710000005},{\"city\":\"Brazil-DistritoFederal-Brasilia\",\"temperature\":\"28\",\"lat\":-15.7942287,\"lng\":-47.882165799999996},{\"city\":\"BritishVirginIslands-Tortola-RoadTown\",\"temperature\":\"26\",\"lat\":18.4286115,\"lng\":-64.6184657},{\"city\":\"Brunei-BandarSeriBegawan\",\"temperature\":\"26\",\"lat\":4.903052199999999,\"lng\":114.93982099999994},{\"city\":\"Bulgaria-Sofia\",\"temperature\":\"14\",\"lat\":42.6977082,\"lng\":23.321867500000053},{\"city\":\"CaboVerde-Praia\",\"temperature\":\"31\",\"lat\":14.93305,\"lng\":-23.513326699999993},{\"city\":\"Cambodia-PhnomPenh\",\"temperature\":\"28\",\"lat\":11.5448729,\"lng\":104.89216680000004},{\"city\":\"Cameroon-Yaoundé\",\"temperature\":\"30\",\"lat\":3.8480325,\"lng\":11.502075200000036},{\"city\":\"Canada-Ontario-Ottawa\",\"temperature\":\"13\",\"lat\":45.4215296,\"lng\":-75.69719309999999},{\"city\":\"CaymanIslands-GeorgeTown\",\"temperature\":\"30\",\"lat\":19.2869323,\"lng\":-81.36743890000002},{\"city\":\"CentralAfricanRepublic-Bangui\",\"temperature\":\"23\",\"lat\":4.3946735,\"lng\":18.558189900000002},{\"city\":\"Chad-Ndjamena\",\"temperature\":\"37\",\"lat\":12.1348457,\"lng\":15.055741500000067},{\"city\":\"Chile-Santiago\",\"temperature\":\"19\",\"lat\":-33.4378305,\"lng\":-70.65044920000003},{\"city\":\"China-BeijingMunicipality-Beijing\",\"temperature\":\"6\",\"lat\":39.904211,\"lng\":116.40739499999995},{\"city\":\"Colombia-Bogota\",\"temperature\":\"18\",\"lat\":4.710988599999999,\"lng\":-74.072092},{\"city\":\"Comoros-Moroni\",\"temperature\":\"28\",\"lat\":-11.7172157,\"lng\":43.24731459999998},{\"city\":\"Congo-Brazzaville\",\"temperature\":\"30\",\"lat\":-4.2633597,\"lng\":15.242885300000012},{\"city\":\"CongoDem.Rep.-Kinshasa\",\"temperature\":\"30\",\"lat\":-4.4419311,\"lng\":15.266293099999984},{\"city\":\"CookIslands-Rarotonga\",\"temperature\":\"24\",\"lat\":-21.2292371,\"lng\":-159.7763491},{\"city\":\"CostaRica-SanJose\",\"temperature\":\"24\",\"lat\":9.9280694,\"lng\":-84.09072459999999},{\"city\":\"Coted'Ivoire(IvoryCoast)-Yamoussoukro\",\"temperature\":\"18\",\"lat\":6.827622799999999,\"lng\":-5.289343300000041},{\"city\":\"Croatia-Zagreb\",\"temperature\":\"14\",\"lat\":45.8150108,\"lng\":15.981919000000062},{\"city\":\"Cuba-Havana\",\"temperature\":\"27\",\"lat\":23.1135925,\"lng\":-82.36659559999998},{\"city\":\"Cyprus-Nicosia\",\"temperature\":\"20\",\"lat\":35.1855659,\"lng\":33.38227640000002},{\"city\":\"CzechRepublic-Prague\",\"temperature\":\"5\",\"lat\":50.0755381,\"lng\":14.43780049999998},{\"city\":\"Denmark-Copenhagen\",\"temperature\":\"4\",\"lat\":55.6760968,\"lng\":12.568337100000008},{\"city\":\"Djibouti-Djibouti\",\"temperature\":\"31\",\"lat\":11.5720765,\"lng\":43.145647499999995},{\"city\":\"Dominica-Roseau\",\"temperature\":\"28\",\"lat\":15.3091676,\"lng\":-61.37935540000001},{\"city\":\"DominicanRepublic-SantoDomingo\",\"temperature\":\"30\",\"lat\":18.4860575,\"lng\":-69.9312117},{\"city\":\"Ecuador-Quito\",\"temperature\":\"18\",\"lat\":-0.1806532,\"lng\":-78.46783820000002},{\"city\":\"Egypt-Cairo\",\"temperature\":\"23\",\"lat\":30.0444196,\"lng\":31.23571160000006},{\"city\":\"ElSalvador-SanSalvador\",\"temperature\":\"24\",\"lat\":13.6929403,\"lng\":-89.21819110000001},{\"city\":\"EquatorialGuinea-Malabo\",\"temperature\":\"30\",\"lat\":3.7504118,\"lng\":8.737103899999966},{\"city\":\"Estonia-Tallinn\",\"temperature\":\"-2\",\"lat\":59.43696079999999,\"lng\":24.75357459999998},{\"city\":\"Ethiopia-AddisAbaba\",\"temperature\":\"19\",\"lat\":8.9806034,\"lng\":38.75776050000002},{\"city\":\"FalklandIslands-Stanley\",\"temperature\":\"12\",\"lat\":-51.6977129,\"lng\":-57.85166270000002},{\"city\":\"Fiji-Suva\",\"temperature\":\"24\",\"lat\":-18.1248086,\"lng\":178.4500789},{\"city\":\"Finland-Helsinki\",\"temperature\":\"-2\",\"lat\":60.16985569999999,\"lng\":24.93837899999994},{\"city\":\"France-Île-de-France-Paris\",\"temperature\":\"10\",\"lat\":48.856614,\"lng\":2.3522219000000177},{\"city\":\"Gabon-Libreville\",\"temperature\":\"28\",\"lat\":0.4161976,\"lng\":9.467267600000014},{\"city\":\"Gambia-Banjul\",\"temperature\":\"32\",\"lat\":13.4548761,\"lng\":-16.579032299999994},{\"city\":\"Georgia-Tbilisi\",\"temperature\":\"6\",\"lat\":41.7151377,\"lng\":44.82709599999998},{\"city\":\"Germany-Berlin-Berlin\",\"temperature\":\"8\",\"lat\":52.52000659999999,\"lng\":13.404953999999975},{\"city\":\"Ghana-Accra\",\"temperature\":\"29\",\"lat\":5.6037168,\"lng\":-0.18696439999996528},{\"city\":\"Gibraltar-Gibraltar\",\"temperature\":\"21\",\"lat\":36.1407734,\"lng\":-5.353599400000007},{\"city\":\"Greece-Athens\",\"temperature\":\"17\",\"lat\":37.9838096,\"lng\":23.727538800000048},{\"city\":\"Greenland-Nuuk\",\"temperature\":\"-3\",\"lat\":64.18140989999999,\"lng\":-51.69413800000001},{\"city\":\"Grenada-SaintGeorge's\",\"temperature\":\"32\",\"lat\":12.0560975,\"lng\":-61.748799599999984},{\"city\":\"Guatemala-GuatemalaCity\",\"temperature\":\"20\",\"lat\":14.6349149,\"lng\":-90.5068824},{\"city\":\"Guinea-Conakry\",\"temperature\":\"31\",\"lat\":9.641185499999999,\"lng\":-13.57840120000003},{\"city\":\"Guinea-Bissau-Bissau\",\"temperature\":\"32\",\"lat\":11.8816553,\"lng\":-15.617794199999935},{\"city\":\"Guyana-Georgetown\",\"temperature\":\"29\",\"lat\":6.8012793,\"lng\":-58.1551255},{\"city\":\"Haiti-Port-au-Prince\",\"temperature\":\"30\",\"lat\":18.594395,\"lng\":-72.30743259999997},{\"city\":\"Honduras-Tegucigalpa\",\"temperature\":\"23\",\"lat\":14.0722751,\"lng\":-87.192136},{\"city\":\"Hungary-Budapest\",\"temperature\":\"11\",\"lat\":47.497912,\"lng\":19.04023499999994},{\"city\":\"Iceland-Reykjavik\",\"temperature\":\"6\",\"lat\":64.12652059999999,\"lng\":-21.817439299999933},{\"city\":\"India-Delhi-NewDelhi\",\"temperature\":\"30\",\"lat\":28.6139391,\"lng\":77.20902120000005},{\"city\":\"Indonesia-JakartaSpecialCapitalRegion-Jakarta\",\"temperature\":\"28\",\"lat\":-6.1744651,\"lng\":106.82274499999994},{\"city\":\"Iran-Tehran\",\"temperature\":\"16\",\"lat\":35.6891975,\"lng\":51.388973599999986},{\"city\":\"Iraq-Baghdad\",\"temperature\":\"24\",\"lat\":33.3128057,\"lng\":44.36148750000007},{\"city\":\"Ireland-Dublin\",\"temperature\":\"9\",\"lat\":53.3498053,\"lng\":-6.260309699999993},{\"city\":\"IsleofMan-Douglas\",\"temperature\":\"10\",\"lat\":54.1523372,\"lng\":-4.4861227999999755},{\"city\":\"Israel-Jerusalem\",\"temperature\":\"21\",\"lat\":31.768319,\"lng\":35.21370999999999},{\"city\":\"Italy-Rome\",\"temperature\":\"20\",\"lat\":41.9027835,\"lng\":12.496365500000024},{\"city\":\"Jamaica-Kingston\",\"temperature\":\"31\",\"lat\":18.0178743,\"lng\":-76.80990409999998},{\"city\":\"Japan-Tokyo\",\"temperature\":\"9\",\"lat\":35.7090259,\"lng\":139.73199249999993},{\"city\":\"Jordan-Amman\",\"temperature\":\"17\",\"lat\":31.9453666,\"lng\":35.92837159999999},{\"city\":\"Kazakhstan-Astana\",\"temperature\":\"-3\",\"lat\":51.16052269999999,\"lng\":71.4703558},{\"city\":\"Kenya-Nairobi\",\"temperature\":\"23\",\"lat\":-1.2920659,\"lng\":36.82194619999996},{\"city\":\"Kiribati-Tarawa\",\"temperature\":\"28\",\"lat\":1.3290526,\"lng\":172.97905279999998},{\"city\":\"Kosovo-Pristina\",\"temperature\":\"14\",\"lat\":42.6629138,\"lng\":21.165502800000013},{\"city\":\"Kuwait-KuwaitCity\",\"temperature\":\"29\",\"lat\":29.375859,\"lng\":47.97740520000002},{\"city\":\"Kyrgyzstan-Bishkek\",\"temperature\":\"20\",\"lat\":42.8746212,\"lng\":74.56976170000007},{\"city\":\"Laos-Vientiane\",\"temperature\":\"26\",\"lat\":17.9757058,\"lng\":102.63310350000006},{\"city\":\"Latvia-Riga\",\"temperature\":\"4\",\"lat\":56.9496487,\"lng\":24.10518639999998},{\"city\":\"Lebanon-Beirut\",\"temperature\":\"22\",\"lat\":33.8937913,\"lng\":35.50177669999994},{\"city\":\"Liberia-Monrovia\",\"temperature\":\"31\",\"lat\":6.2907432,\"lng\":-10.760523899999953},{\"city\":\"Liechtenstein-Vaduz\",\"temperature\":\"12\",\"lat\":47.1410303,\"lng\":9.520927700000016},{\"city\":\"Lithuania-Vilnius\",\"temperature\":\"3\",\"lat\":54.6871555,\"lng\":25.279651400000034},{\"city\":\"Luxembourg-Luxembourg\",\"temperature\":\"9\",\"lat\":49.61162100000001,\"lng\":6.131934600000022},{\"city\":\"Macedonia\",\"temperature\":\"13\",\"lat\":41.608635,\"lng\":21.745274999999992},{\"city\":\"Madagascar-Antananarivo\",\"temperature\":\"21\",\"lat\":-18.8791902,\"lng\":47.50790549999999},{\"city\":\"Malawi-Lilongwe\",\"temperature\":\"28\",\"lat\":-13.9626121,\"lng\":33.77411949999998},{\"city\":\"Malaysia-KualaLumpur\",\"temperature\":\"27\",\"lat\":3.139003,\"lng\":101.68685499999992},{\"city\":\"Maldives-Male\",\"temperature\":\"28\",\"lat\":4.1754959,\"lng\":73.50934740000002},{\"city\":\"Mali-Bamako\",\"temperature\":\"29\",\"lat\":12.6392316,\"lng\":-8.002889200000027},{\"city\":\"Malta-Valletta\",\"temperature\":\"21\",\"lat\":35.8989085,\"lng\":14.514552800000047},{\"city\":\"MarshallIslands-Majuro\",\"temperature\":\"29\",\"lat\":7.0921515,\"lng\":171.38255819999995},{\"city\":\"Mauritania-Nouakchott\",\"temperature\":\"35\",\"lat\":18.0735299,\"lng\":-15.958237199999985},{\"city\":\"Mauritius-PortLouis\",\"temperature\":\"22\",\"lat\":-20.1608912,\"lng\":57.50122220000003},{\"city\":\"Mexico-CiudaddeMéxico-MexicoCity\",\"temperature\":\"10\",\"lat\":19.4326077,\"lng\":-99.13320799999997},{\"city\":\"Micronesia-Pohnpei-Palikir\",\"temperature\":\"25\",\"lat\":6.9147118,\"lng\":158.16102739999997},{\"city\":\"Moldova-Chișinău\",\"temperature\":\"9\",\"lat\":47.0104529,\"lng\":28.86381030000007},{\"city\":\"Monaco-Monaco\",\"temperature\":\"20\",\"lat\":43.73741099999999,\"lng\":7.420816000000059},{\"city\":\"Mongolia-Ulaanbaatar\",\"temperature\":\"-4\",\"lat\":47.88639879999999,\"lng\":106.90574390000006},{\"city\":\"Montenegro-Podgorica\",\"temperature\":\"15\",\"lat\":42.4304196,\"lng\":19.259364199999936},{\"city\":\"Montserrat-Brades\",\"temperature\":\"26\",\"lat\":16.7909044,\"lng\":-62.21062410000002},{\"city\":\"Morocco-Rabat\",\"temperature\":\"27\",\"lat\":33.9715904,\"lng\":-6.849812899999961},{\"city\":\"Mozambique-Maputo\",\"temperature\":\"25\",\"lat\":-25.891968,\"lng\":32.605135099999984},{\"city\":\"Namibia-Windhoek\",\"temperature\":\"33\",\"lat\":-22.5608807,\"lng\":17.0657549},{\"city\":\"Nepal-Kathmandu\",\"temperature\":\"16\",\"lat\":27.7172453,\"lng\":85.3239605},{\"city\":\"Netherlands-Amsterdam\",\"temperature\":\"10\",\"lat\":52.3702157,\"lng\":4.895167899999933},{\"city\":\"NewZealand-Wellington\",\"temperature\":\"12\",\"lat\":-41.2864603,\"lng\":174.77623600000004},{\"city\":\"Nicaragua-Managua\",\"temperature\":\"28\",\"lat\":12.1149926,\"lng\":-86.23617439999998},{\"city\":\"Niger-Niamey\",\"temperature\":\"39\",\"lat\":13.5115963,\"lng\":2.1253854000000274},{\"city\":\"Niue-Alofi\",\"temperature\":\"24\",\"lat\":-19.0553711,\"lng\":-169.91787090000003},{\"city\":\"NorthKorea-Pyongyang\",\"temperature\":\"3\",\"lat\":39.0392193,\"lng\":125.76252410000006},{\"city\":\"Norway-Oslo\",\"temperature\":\"3\",\"lat\":59.9138688,\"lng\":10.752245399999993},{\"city\":\"Oman-Muscat\",\"temperature\":\"28\",\"lat\":23.58589,\"lng\":58.40592270000002},{\"city\":\"Pakistan-Islamabad\",\"temperature\":\"22\",\"lat\":33.7293882,\"lng\":73.09314610000001},{\"city\":\"Panama-Panama\",\"temperature\":\"28\",\"lat\":9.1011785,\"lng\":-79.4028639},{\"city\":\"PapuaNewGuinea-PortMoresby\",\"temperature\":\"26\",\"lat\":-9.443800399999999,\"lng\":147.18026710000004},{\"city\":\"Paraguay-Asuncion\",\"temperature\":\"20\",\"lat\":-25.2637399,\"lng\":-57.57592599999998},{\"city\":\"Peru-Lima-Lima\",\"temperature\":\"17\",\"lat\":-12.046374,\"lng\":-77.0427934},{\"city\":\"Philippines-Manila\",\"temperature\":\"25\",\"lat\":14.5995124,\"lng\":120.9842195},{\"city\":\"Poland-Warsaw\",\"temperature\":\"5\",\"lat\":52.2296756,\"lng\":21.012228700000037},{\"city\":\"Portugal-Lisbon\",\"temperature\":\"20\",\"lat\":38.7222524,\"lng\":-9.139336599999979},{\"city\":\"PuertoRico-SanJuan\",\"temperature\":\"31\",\"lat\":18.4655394,\"lng\":-66.10573549999998},{\"city\":\"Qatar-Doha\",\"temperature\":\"29\",\"lat\":25.2854473,\"lng\":51.53103979999992},{\"city\":\"Réunion(French)-Saint-Denis\",\"temperature\":\"22\",\"lat\":-20.88554,\"lng\":55.45723899999996},{\"city\":\"Romania-Bucharest\",\"temperature\":\"14\",\"lat\":44.4267674,\"lng\":26.102538399999958},{\"city\":\"Russia-Moscow\",\"temperature\":\"-2\",\"lat\":55.755826,\"lng\":37.6173},{\"city\":\"Rwanda-Kigali\",\"temperature\":\"22\",\"lat\":-1.9705786,\"lng\":30.10442880000005},{\"city\":\"SaintHelena-Jamestown\",\"temperature\":\"19\",\"lat\":-15.9286343,\"lng\":-5.715174899999965},{\"city\":\"SaintKittsandNevis-Basseterre\",\"temperature\":\"25\",\"lat\":17.3026058,\"lng\":-62.71769240000003},{\"city\":\"SaintLucia-Castries\",\"temperature\":\"26\",\"lat\":14.0101094,\"lng\":-60.98746870000002},{\"city\":\"SaintVincentandGrenadines-Kingstown\",\"temperature\":\"25\",\"lat\":13.1600249,\"lng\":-61.22481570000002},{\"city\":\"Samoa-Apia\",\"temperature\":\"25\",\"lat\":-13.8506958,\"lng\":-171.7513551},{\"city\":\"SanMarino-SanMarino\",\"temperature\":\"15\",\"lat\":43.9355907,\"lng\":12.4472806},{\"city\":\"SaoTomeandPrincipe-SãoTomé\",\"temperature\":\"30\",\"lat\":0.3301924,\"lng\":6.733342999999991},{\"city\":\"SaudiArabia-Riyadh\",\"temperature\":\"28\",\"lat\":24.7135517,\"lng\":46.67529569999999},{\"city\":\"Senegal-Dakar\",\"temperature\":\"31\",\"lat\":14.7645042,\"lng\":-17.366028599999936},{\"city\":\"Serbia-Belgrade\",\"temperature\":\"16\",\"lat\":44.786568,\"lng\":20.44892159999995},{\"city\":\"Seychelles-Victoria\",\"temperature\":\"27\",\"lat\":-4.619143,\"lng\":55.45131489999994},{\"city\":\"SierraLeone-Freetown\",\"temperature\":\"30\",\"lat\":8.4656765,\"lng\":-13.231722499999933},{\"city\":\"Singapore-Singapore\",\"temperature\":\"27\",\"lat\":1.3553794,\"lng\":103.86774439999999},{\"city\":\"Slovakia-Bratislava\",\"temperature\":\"8\",\"lat\":48.1485965,\"lng\":17.107747700000004},{\"city\":\"Slovenia-Ljubljana\",\"temperature\":\"11\",\"lat\":46.0569465,\"lng\":14.505751499999974},{\"city\":\"SolomonIslands-Gizo\",\"temperature\":\"25\",\"lat\":-8.1058258,\"lng\":156.83499860000006},{\"city\":\"SolomonIslands-Honiara\",\"temperature\":\"24\",\"lat\":-9.4456381,\"lng\":159.97289990000002},{\"city\":\"SouthAfrica-Pretoria\",\"temperature\":\"28\",\"lat\":-25.7478676,\"lng\":28.22927119999997},{\"city\":\"SouthKorea-Seoul\",\"temperature\":\"6\",\"lat\":37.566535,\"lng\":126.97796919999996},{\"city\":\"Spain-Madrid\",\"temperature\":\"21\",\"lat\":40.4167754,\"lng\":-3.7037901999999576},{\"city\":\"SriLanka-SriJayawardenapuraKotte\",\"temperature\":\"27\",\"lat\":6.894002899999999,\"lng\":79.90515649999998},{\"city\":\"Sudan-Khartoum\",\"temperature\":\"36\",\"lat\":15.5006544,\"lng\":32.55989939999995},{\"city\":\"Swaziland-Mbabane\",\"temperature\":\"23\",\"lat\":-26.3054482,\"lng\":31.136671500000034},{\"city\":\"Sweden-Stockholm\",\"temperature\":\"1\",\"lat\":59.32932349999999,\"lng\":18.068580800000063},{\"city\":\"Switzerland-Bern-Bern\",\"temperature\":\"13\",\"lat\":46.9479739,\"lng\":7.447446799999966},{\"city\":\"Syria-Damascus\",\"temperature\":\"19\",\"lat\":33.5138073,\"lng\":36.27652790000002},{\"city\":\"Taiwan-Taipei\",\"temperature\":\"21\",\"lat\":25.0329636,\"lng\":121.56542680000007},{\"city\":\"Tajikistan-Dushanbe\",\"temperature\":\"17\",\"lat\":38.5597722,\"lng\":68.78703840000003},{\"city\":\"Tanzania-Dodoma\",\"temperature\":\"30\",\"lat\":-6.162959000000001,\"lng\":35.75160690000007},{\"city\":\"Thailand-Bangkok\",\"temperature\":\"30\",\"lat\":13.82031,\"lng\":100.66471009999998},{\"city\":\"Togo-Lomé\",\"temperature\":\"32\",\"lat\":6.1724969,\"lng\":1.2313618000000588},{\"city\":\"Tonga-Nukualofa\",\"temperature\":\"22\",\"lat\":-21.1393418,\"lng\":-175.204947},{\"city\":\"TrinidadandTobago-PortofSpain\",\"temperature\":\"30\",\"lat\":10.6549013,\"lng\":-61.50192559999999},{\"city\":\"Tunisia-Tunis\",\"temperature\":\"24\",\"lat\":36.8064948,\"lng\":10.181531599999971},{\"city\":\"Turkey-Ankara\",\"temperature\":\"5\",\"lat\":39.9333635,\"lng\":32.85974190000002},{\"city\":\"Turkmenistan-Ashgabat\",\"temperature\":\"18\",\"lat\":37.9600766,\"lng\":58.32606290000001},{\"city\":\"Tuvalu-Funafuti\",\"temperature\":\"28\",\"lat\":-8.5200657,\"lng\":179.198128},{\"city\":\"Uganda-Kampala\",\"temperature\":\"27\",\"lat\":0.3475964,\"lng\":32.582519700000034},{\"city\":\"Ukraine-Kyiv\",\"temperature\":\"2\",\"lat\":50.4501,\"lng\":30.523400000000038},{\"city\":\"UnitedArabEmirates-AbuDhabi-AbuDhabi\",\"temperature\":\"31\",\"lat\":24.2991738,\"lng\":54.69727739999996},{\"city\":\"UnitedKingdom-England-London\",\"temperature\":\"10\",\"lat\":51.5073509,\"lng\":-0.12775829999998223},{\"city\":\"Uruguay-Montevideo\",\"temperature\":\"12\",\"lat\":-34.9011127,\"lng\":-56.16453139999999},{\"city\":\"USA-DistrictofColumbia-WashingtonDC\",\"temperature\":\"16\",\"lat\":38.9071923,\"lng\":-77.03687070000001},{\"city\":\"Uzbekistan-Tashkent\",\"temperature\":\"21\",\"lat\":41.2994958,\"lng\":69.24007340000003},{\"city\":\"Vanuatu-PortVila\",\"temperature\":\"19\",\"lat\":-17.7332512,\"lng\":168.32732450000003},{\"city\":\"VaticanCityState-VaticanCity\",\"temperature\":\"20\",\"lat\":41.902916,\"lng\":12.453389000000016},{\"city\":\"Vietnam-Hanoi\",\"temperature\":\"21\",\"lat\":21.0277644,\"lng\":105.83415979999995},{\"city\":\"Yemen-Sana\",\"temperature\":\"21\",\"lat\":15.3694451,\"lng\":44.19100660000004},{\"city\":\"Zimbabwe-Harare\",\"temperature\":\"29\",\"lat\":-17.8251657,\"lng\":31.03350999999998}]";
    Gson gson = new Gson();
    CityTemperature[] citiesTemperature = gson.fromJson(citiesTemp, CityTemperature[].class);
    MessageDigest md = MessageDigest.getInstance("MD5");
    List<KV<String, CityTemperature>> cities = new ArrayList<>();
    for (CityTemperature city : citiesTemperature) {
      String currentId = city.getLat() + "-" + city.getLng();
      String key = toHexString(md.digest(currentId.getBytes("UTF-8")));
      cities.add(KV.of(key, city));
    }
    return cities;
  }

  /**
   * Convert a bytes array into a HEX string
   *
   * @param bytes the bytes array that you want to convert
   * @return an HEX string representing the bytes array
   */
  public static String toHexString(byte[] bytes) {
    StringBuilder hexString = new StringBuilder();
    for (int i = 0; i < bytes.length; i++) {
      String hex = Integer.toHexString(0xFF & bytes[i]);
      if (hex.length() == 1) {
        hexString.append('0');
      }
      hexString.append(hex);
    }
    return hexString.toString().toUpperCase();
  }
}
